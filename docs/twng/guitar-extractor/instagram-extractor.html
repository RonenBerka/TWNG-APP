<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>TWNG Guitar Story Extractor</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #0a0a0a;
      color: #e0e0e0;
      min-height: 100vh;
      padding: 24px;
    }

    .container {
      max-width: 1600px;
      margin: 0 auto;
    }

    h1 {
      font-size: 28px;
      color: #F59E0B;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .subtitle {
      color: #666;
      margin-bottom: 32px;
    }

    .workflow {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 24px;
      margin-bottom: 24px;
    }

    .step {
      background: #1a1a1a;
      border-radius: 12px;
      padding: 20px;
      border: 1px solid #333;
    }

    .step-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 16px;
    }

    .step-number {
      width: 32px;
      height: 32px;
      background: #F59E0B;
      color: black;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      flex-shrink: 0;
    }

    .step-title {
      font-size: 16px;
      font-weight: 600;
    }

    textarea, input[type="text"] {
      width: 100%;
      padding: 12px;
      border: 1px solid #333;
      border-radius: 8px;
      background: #252525;
      color: white;
      font-size: 14px;
      resize: vertical;
    }

    textarea:focus, input:focus {
      outline: none;
      border-color: #F59E0B;
    }

    .input-group {
      margin-bottom: 16px;
    }

    .input-group label {
      display: block;
      margin-bottom: 6px;
      font-size: 13px;
      color: #888;
    }

    .btn {
      padding: 12px 24px;
      background: #F59E0B;
      border: none;
      border-radius: 8px;
      color: black;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 14px;
    }

    .btn:hover {
      background: #D97706;
    }

    .btn:disabled {
      background: #444;
      cursor: not-allowed;
    }

    .btn-secondary {
      background: #333;
      color: white;
    }

    .btn-secondary:hover {
      background: #444;
    }

    .btn-copy {
      background: #10B981;
    }

    .guitar-card {
      background: linear-gradient(135deg, #1a1a1a 0%, #252525 100%);
      border: 1px solid #F59E0B33;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 16px;
    }

    .guitar-card h3 {
      color: #F59E0B;
      margin-bottom: 16px;
      font-size: 16px;
    }

    .field-row {
      display: flex;
      gap: 12px;
      margin-bottom: 12px;
    }

    .field {
      flex: 1;
    }

    .field label {
      display: block;
      font-size: 11px;
      text-transform: uppercase;
      color: #666;
      margin-bottom: 4px;
    }

    .field input, .field textarea {
      font-size: 14px;
    }

    .outreach-box {
      background: #1a2a1a;
      border: 1px solid #10B98133;
      border-radius: 12px;
      padding: 20px;
    }

    .outreach-box h3 {
      color: #10B981;
      margin-bottom: 16px;
    }

    .tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
    }

    .tab {
      padding: 8px 16px;
      background: #252525;
      border: none;
      border-radius: 6px;
      color: #888;
      cursor: pointer;
      font-size: 13px;
    }

    .tab.active {
      background: #10B981;
      color: black;
    }

    .actions {
      display: flex;
      gap: 12px;
      margin-top: 16px;
      flex-wrap: wrap;
    }

    .status {
      padding: 8px 12px;
      border-radius: 6px;
      font-size: 13px;
      margin-top: 12px;
    }

    .status.success {
      background: #10B98122;
      color: #10B981;
    }

    .status.error {
      background: #EF444422;
      color: #EF4444;
    }

    .help-text {
      font-size: 12px;
      color: #666;
      margin-top: 8px;
    }

    .hashtags {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 12px;
    }

    .hashtag {
      padding: 4px 10px;
      background: #333;
      border-radius: 4px;
      font-size: 12px;
      color: #888;
    }

    /* New sections */
    .enrichment-section {
      background: #1a1a2a;
      border: 1px solid #6366F133;
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 16px;
    }

    .enrichment-section h4 {
      color: #818CF8;
      font-size: 14px;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .specs-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }

    .spec-item {
      background: #252535;
      padding: 8px 12px;
      border-radius: 6px;
      font-size: 12px;
    }

    .spec-item .label {
      color: #666;
      font-size: 10px;
      text-transform: uppercase;
      margin-bottom: 2px;
    }

    .spec-item .value {
      color: #e0e0e0;
    }

    .artists-list {
      display: flex;
      flex-direction: column;
      gap: 4px;
      max-height: 250px;
      overflow-y: auto;
    }

    .artist-tag {
      background: #3B2A1A;
      border: 1px solid #F59E0B44;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 12px;
      color: #F59E0B;
    }

    .artist-card {
      background: #252525;
      border: 1px solid #F59E0B33;
      border-radius: 8px;
      padding: 10px 12px;
      margin-bottom: 8px;
    }

    .artist-card .artist-name {
      color: #F59E0B;
      font-weight: 600;
      font-size: 13px;
    }

    .artist-card .artist-guitar {
      color: #10B981;
      font-size: 12px;
      margin-top: 2px;
    }

    .artist-card .artist-notes {
      color: #888;
      font-size: 11px;
      margin-top: 4px;
      font-style: italic;
    }

    .songs-list {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .song-item {
      background: #1A2A1A;
      padding: 8px 12px;
      border-radius: 6px;
      font-size: 12px;
      display: flex;
      justify-content: space-between;
    }

    .song-item .title {
      color: #10B981;
    }

    .song-item .artist {
      color: #666;
    }

    .bottom-section {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      margin-top: 24px;
    }

    .json-output {
      background: #151515;
      border: 1px solid #333;
      border-radius: 8px;
      padding: 16px;
      font-family: 'Monaco', 'Menlo', monospace;
      font-size: 11px;
      white-space: pre-wrap;
      max-height: 300px;
      overflow-y: auto;
      color: #10B981;
    }

    .copy-json-btn {
      position: absolute;
      top: 8px;
      left: 8px;
      padding: 6px 12px;
      font-size: 11px;
    }

    .json-container {
      position: relative;
    }

    .json-container h4 {
      color: #666;
      font-size: 12px;
      margin-bottom: 8px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ¸ TWNG Guitar Story Extractor</h1>
    <p class="subtitle">×—×™×œ×•×¥ ×¡×™×¤×•×¨×™ ×’×™×˜×¨×•×ª ×××™× ×¡×˜×’×¨× â†’ ×”×¢×©×¨×” ××•×˜×•××˜×™×ª â†’ ×›×¨×˜×™×¡ TWNG ××•×›×Ÿ</p>

    <div class="workflow">
      <!-- Step 1: Input -->
      <div class="step">
        <div class="step-header">
          <div class="step-number">1</div>
          <div class="step-title">×”×–×Ÿ ××™×“×¢ ××”×¤×•×¡×˜</div>
        </div>

        <div class="input-group">
          <label>×§×™×©×•×¨ ×œ×¤×•×¡×˜</label>
          <input type="text" id="postUrl" placeholder="https://www.instagram.com/p/...">
        </div>

        <div class="input-group">
          <label>×©× ××©×ª××©</label>
          <input type="text" id="username" placeholder="@guitarplayer123">
        </div>

        <div class="input-group">
          <label>×˜×§×¡×˜ ×”×¤×•×¡×˜ (×”×¢×ª×§ ×•×”×“×‘×§)</label>
          <textarea id="postText" rows="6" placeholder="×”×“×‘×§ ×›××Ÿ ××ª ×”×˜×§×¡×˜ ×”××œ× ××”×¤×•×¡×˜..."></textarea>
        </div>

        <div class="input-group">
          <label>×§×™×©×•×¨×™ ×ª××•× ×•×ª (×©×•×¨×” ×œ×›×œ ×ª××•× ×”)</label>
          <textarea id="imageUrls" rows="3" placeholder="https://...jpg&#10;https://...jpg"></textarea>
          <p class="help-text">ğŸ’¡ ×§×œ×™×§ ×™×× ×™ ×¢×œ ×”×ª××•× ×” â†’ "Copy Image Address"</p>
        </div>

        <button class="btn" onclick="analyzePost()">ğŸ” × ×ª×— ×•×—×œ×¥ ××™×“×¢</button>
      </div>

      <!-- Step 2: Extracted Data + Enrichment -->
      <div class="step">
        <div class="step-header">
          <div class="step-number">2</div>
          <div class="step-title">××™×“×¢ + ×”×¢×©×¨×” ××•×˜×•××˜×™×ª</div>
        </div>

        <div class="guitar-card">
          <h3>ğŸ¸ ×¤×¨×˜×™ ×”×’×™×˜×¨×”</h3>

          <div class="field-row">
            <div class="field">
              <label>×™×¦×¨×Ÿ</label>
              <input type="text" id="brand" placeholder="Fender" onchange="enrichData()">
            </div>
            <div class="field">
              <label>×“×’×</label>
              <input type="text" id="model" placeholder="Stratocaster" onchange="enrichData()">
            </div>
          </div>

          <div class="field-row">
            <div class="field">
              <label>×©× ×”</label>
              <input type="text" id="year" placeholder="1972">
            </div>
            <div class="field">
              <label>×¦×‘×¢</label>
              <input type="text" id="color" placeholder="Sunburst">
            </div>
          </div>

          <div class="field-row">
            <div class="field">
              <label>××¡×¤×¨ ×¡×™×“×•×¨×™</label>
              <input type="text" id="serial" placeholder="S7xxxxx">
            </div>
            <div class="field">
              <label>××¦×‘</label>
              <input type="text" id="condition" placeholder="Vintage / Mint / Player">
            </div>
          </div>

          <div class="field">
            <label>×”×¡×™×¤×•×¨ (××•×ª×× ×œ-TWNG)</label>
            <textarea id="story" rows="3" placeholder="×”×¡×™×¤×•×¨ ×™×•×¤×™×¢ ×›××Ÿ..."></textarea>
          </div>
        </div>

        <!-- Specs Section -->
        <div class="enrichment-section" id="specsSection" style="display: none;">
          <h4>ğŸ“‹ ××¤×¨×˜ ×˜×›× ×™ ××•××œ×¥</h4>
          <div class="specs-grid" id="specsGrid"></div>
        </div>

        <!-- Artists Section -->
        <div class="enrichment-section" id="artistsSection" style="display: none;">
          <h4>ğŸŒŸ ××× ×™× ××¤×•×¨×¡××™×</h4>
          <div class="artists-list" id="artistsList"></div>
        </div>

        <!-- Songs Section -->
        <div class="enrichment-section" id="songsSection" style="display: none;">
          <h4>ğŸµ ×©×™×¨×™× ××¤×•×¨×¡××™×</h4>
          <div class="songs-list" id="songsList"></div>
        </div>
      </div>

      <!-- Step 3: Outreach -->
      <div class="step">
        <div class="step-header">
          <div class="step-number">3</div>
          <div class="step-title">×¤× ×™×™×” ×œ×‘×¢×œ×™×</div>
        </div>

        <div class="outreach-box">
          <h3>âœ‰ï¸ ×”×•×“×¢×” ××•×›× ×”</h3>

          <div class="tabs">
            <button class="tab active" onclick="switchLang('en')">English</button>
            <button class="tab" onclick="switchLang('he')">×¢×‘×¨×™×ª</button>
          </div>

          <div class="field">
            <textarea id="outreachMessage" rows="8"></textarea>
          </div>

          <div class="actions">
            <button class="btn btn-copy" onclick="copyOutreach()">ğŸ“‹ ×”×¢×ª×§ ×”×•×“×¢×”</button>
            <button class="btn btn-secondary" onclick="openInstagramDM()">ğŸ“¨ ×¤×ª×— DM</button>
          </div>
        </div>

        <div id="statusMessage"></div>
      </div>
    </div>

    <!-- Bottom Section: JSON Output + Hashtags -->
    <div class="bottom-section">
      <div class="json-container">
        <h4>ğŸ“¦ JSON ××•×›×Ÿ ×œ-Supabase</h4>
        <button class="btn btn-secondary copy-json-btn" onclick="copyGuitarJSON()">ğŸ“‹ ×”×¢×ª×§</button>
        <div class="json-output" id="jsonOutput">// ×”×¨×¥ × ×™×ª×•×— ×›×“×™ ×œ×¨××•×ª ××ª ×”-JSON</div>
      </div>

      <div class="step" style="margin-top: 0;">
        <div class="step-header">
          <div class="step-number">ğŸ”</div>
          <div class="step-title">×”××©×˜××’×™× ××•××œ×¦×™× ×œ×—×™×¤×•×©</div>
        </div>
        <div class="hashtags">
          <span class="hashtag">#myfirstguitar</span>
          <span class="hashtag">#guitarlove</span>
          <span class="hashtag">#guitarstory</span>
          <span class="hashtag">#ngd</span>
          <span class="hashtag">#newguitarday</span>
          <span class="hashtag">#vintageguitar</span>
          <span class="hashtag">#guitarcollection</span>
          <span class="hashtag">#guitarplayer</span>
          <span class="hashtag">#fenderguitar</span>
          <span class="hashtag">#gibsonguitar</span>
          <span class="hashtag">#guitargear</span>
          <span class="hashtag">#guitarlife</span>
          <span class="hashtag">#myfavoriteguitar</span>
          <span class="hashtag">#guitarstories</span>
          <span class="hashtag">#guitarmemories</span>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ===== GUITAR KNOWLEDGE DATABASE =====

    const BRANDS = ['Fender', 'Gibson', 'PRS', 'Ibanez', 'Epiphone', 'Martin', 'Taylor', 'Gretsch', 'Rickenbacker', 'ESP', 'Jackson', 'Schecter', 'Squier', 'Guild', 'Yamaha', 'Washburn', 'Dean', 'BC Rich', 'Charvel', 'Suhr', 'Music Man', 'Ernie Ball'];

    const MODELS = {
      'Fender': ['Stratocaster', 'Telecaster', 'Jazzmaster', 'Jaguar', 'Mustang', 'Jazz Bass', 'Precision Bass', 'Strat', 'Tele'],
      'Gibson': ['Les Paul', 'SG', 'ES-335', 'Flying V', 'Explorer', 'Firebird', 'ES-175', 'L-00', 'J-45', 'Hummingbird'],
      'PRS': ['Custom 24', 'McCarty', 'Silver Sky', 'SE', 'Hollowbody'],
      'Ibanez': ['RG', 'JEM', 'S', 'Prestige', 'AZ', 'Artcore'],
      'Martin': ['D-28', 'D-18', 'OM-28', '000-15', 'HD-28'],
      'Taylor': ['814ce', '314ce', 'GS Mini', 'Academy']
    };

    const COLORS = ['Sunburst', 'Black', 'White', 'Natural', 'Cherry', 'Vintage White', 'Olympic White', 'Fiesta Red', 'Surf Green', 'Lake Placid Blue', 'Butterscotch', 'Blonde', 'Tobacco Burst', 'Wine Red', 'Pelham Blue', 'Sea Foam Green', 'Candy Apple Red', 'Shell Pink', 'Sonic Blue', '3-Tone Sunburst', 'Goldtop', 'Heritage Cherry', 'TV Yellow'];

    // ===== SPECS DATABASE =====
    const GUITAR_SPECS = {
      'Fender Stratocaster': {
        body: 'Alder / Ash',
        neck: 'Maple',
        fretboard: 'Maple / Rosewood',
        pickups: '3x Single Coil',
        bridge: 'Tremolo',
        scale: '25.5"',
        frets: '21-22'
      },
      'Fender Telecaster': {
        body: 'Alder / Ash',
        neck: 'Maple',
        fretboard: 'Maple / Rosewood',
        pickups: '2x Single Coil',
        bridge: 'Fixed / String-through',
        scale: '25.5"',
        frets: '21-22'
      },
      'Fender Jazzmaster': {
        body: 'Alder',
        neck: 'Maple',
        fretboard: 'Rosewood',
        pickups: '2x Jazzmaster Single Coil',
        bridge: 'Floating Tremolo',
        scale: '25.5"',
        frets: '21-22'
      },
      'Fender Jaguar': {
        body: 'Alder',
        neck: 'Maple',
        fretboard: 'Rosewood',
        pickups: '2x Single Coil',
        bridge: 'Floating Tremolo',
        scale: '24"',
        frets: '22'
      },
      'Gibson Les Paul': {
        body: 'Mahogany + Maple Top',
        neck: 'Mahogany',
        fretboard: 'Rosewood / Ebony',
        pickups: '2x Humbucker',
        bridge: 'Tune-O-Matic',
        scale: '24.75"',
        frets: '22'
      },
      'Gibson SG': {
        body: 'Mahogany',
        neck: 'Mahogany',
        fretboard: 'Rosewood',
        pickups: '2x Humbucker',
        bridge: 'Tune-O-Matic',
        scale: '24.75"',
        frets: '22'
      },
      'Gibson ES-335': {
        body: 'Maple/Poplar/Maple (Semi-Hollow)',
        neck: 'Mahogany',
        fretboard: 'Rosewood',
        pickups: '2x Humbucker',
        bridge: 'Tune-O-Matic',
        scale: '24.75"',
        frets: '22'
      },
      'PRS Custom 24': {
        body: 'Mahogany + Maple Top',
        neck: 'Mahogany',
        fretboard: 'Rosewood',
        pickups: '2x Humbucker (Coil Split)',
        bridge: 'PRS Tremolo',
        scale: '25"',
        frets: '24'
      },
      'Ibanez RG': {
        body: 'Basswood / Mahogany',
        neck: 'Maple / Wizard',
        fretboard: 'Rosewood / Maple',
        pickups: 'HSH or HSS',
        bridge: 'Floyd Rose / Edge',
        scale: '25.5"',
        frets: '24'
      },
      'Gretsch White Falcon': {
        body: 'Maple (Hollow)',
        neck: 'Maple',
        fretboard: 'Ebony',
        pickups: '2x Filter\'Tron',
        bridge: 'Bigsby Tremolo',
        scale: '25.5"',
        frets: '22'
      }
    };

    // ===== FAMOUS ARTISTS DATABASE (Year-Specific) =====
    // Format: { artist, years, guitar, notes }
    const FAMOUS_ARTISTS_DETAILED = {
      'Fender Stratocaster': [
        { artist: 'Jimi Hendrix', years: '1968', guitar: '1968 Olympic White Stratocaster', notes: '×”×’×™×˜×¨×” ×-Woodstock' },
        { artist: 'Eric Clapton', years: '1956-1957', guitar: '"Brownie" 1956 Sunburst', notes: '×©×™××© ×‘-Layla' },
        { artist: 'Eric Clapton', years: '1956', guitar: '"Blackie" (×”×¨×›×‘×” ××—×œ×§×™ 56-57)', notes: '×”×’×™×˜×¨×” ×”××™×™×§×•× ×™×ª ×©×œ×•' },
        { artist: 'Stevie Ray Vaughan', years: '1962-1963', guitar: '"Number One" 1962/63', notes: '×”×¦×œ×™×œ ×©×œ Texas Blues' },
        { artist: 'David Gilmour', years: '1969', guitar: '"The Black Strat" 1969', notes: '×”×¡×•×œ×•××™× ×©×œ Pink Floyd' },
        { artist: 'John Mayer', years: '1963-1964', guitar: '××¡×¤×¨ Strats ×-63-64', notes: '×œ×¤× ×™ ×”××¢×‘×¨ ×œ-PRS' },
        { artist: 'Mark Knopfler', years: '1961', guitar: '1961 Fiesta Red', notes: 'Sultans of Swing' },
        { artist: 'Rory Gallagher', years: '1961', guitar: '1961 Sunburst (heavily worn)', notes: '××—×ª ×”×’×™×˜×¨×•×ª ×”×›×™ ×‘×œ×•×™×•×ª ×‘×”×™×¡×˜×•×¨×™×”' },
        { artist: 'Yngwie Malmsteen', years: '1971', guitar: '"Duck" 1971 Olympic White', notes: 'Scalloped fretboard' },
        { artist: 'Ritchie Blackmore', years: '1974', guitar: '1974 Olympic White', notes: 'Deep Purple / Rainbow' }
      ],
      'Fender Telecaster': [
        { artist: 'Keith Richards', years: '1953', guitar: '"Micawber" 1953', notes: '5 ××™×ª×¨×™×, Open G tuning' },
        { artist: 'Bruce Springsteen', years: '1950s', guitar: '"Esquire" 1950s', notes: 'Born to Run era' },
        { artist: 'Jimmy Page', years: '1959', guitar: '"Dragon Telecaster" 1959', notes: '×œ×¤× ×™ ×©×¢×‘×¨ ×œ-Les Paul' },
        { artist: 'Prince', years: '1970s', guitar: 'Hohner Telecaster copy', notes: 'Purple Rain' },
        { artist: 'Joe Strummer', years: '1966', guitar: '1966 Sunburst', notes: 'The Clash' },
        { artist: 'Andy Summers', years: '1961', guitar: '1961 Custom', notes: 'The Police - ×¢× Humbucker' },
        { artist: 'Brad Paisley', years: '1968', guitar: '"Old Pink" 1968 Paisley', notes: 'Country icon' }
      ],
      'Fender Jazzmaster': [
        { artist: 'Elvis Costello', years: '1966', guitar: '1966 Sunburst', notes: 'Rhythm Neck pickup' },
        { artist: 'Kevin Shields', years: '1965', guitar: '××¡×¤×¨ Jazzmasters ×-60s', notes: 'My Bloody Valentine shoegaze' },
        { artist: 'J Mascis', years: '1963', guitar: 'Purple 1963', notes: 'Dinosaur Jr.' },
        { artist: 'Thurston Moore', years: '1960s', guitar: '××¡×¤×¨ Jazzmasters', notes: 'Sonic Youth - alternate tunings' }
      ],
      'Fender Jaguar': [
        { artist: 'Kurt Cobain', years: '1965', guitar: '1965 Sunburst', notes: 'In Utero era' },
        { artist: 'Johnny Marr', years: '1962', guitar: '1962 Sunburst', notes: 'The Smiths' },
        { artist: 'John Frusciante', years: '1962', guitar: '1962 Sunburst', notes: 'RHCP - Californication' }
      ],
      'Gibson Les Paul': [
        { artist: 'Jimmy Page', years: '1959', guitar: '"Number One" 1959 Standard', notes: 'LED ZEPPELIN - ×”×’×™×˜×¨×” ×”××’×“×™×ª' },
        { artist: 'Jimmy Page', years: '1960', guitar: '"Number Two" 1960 Standard', notes: 'Backup ×œ×’×™×˜×¨×” ×”×¨××©×™×ª' },
        { artist: 'Peter Green', years: '1959', guitar: '1959 Standard (reversed pickup)', notes: 'Out of phase sound - ×¢×‘×¨×” ×œ×’××¨×™ ××•×¨' },
        { artist: 'Gary Moore', years: '1959', guitar: '1959 Standard (×©×œ Peter Green)', notes: 'Still Got the Blues - ×”×¤×™×§××¤ ×”×”×¤×•×š' },
        { artist: 'Slash', years: '1959', guitar: '"Jessica" 1959 replica + 1959 AFD', notes: 'Appetite for Destruction' },
        { artist: 'Duane Allman', years: '1957', guitar: '"Layla" 1957 Goldtop', notes: '×¢× P-90s, ×•××– Humbuckers' },
        { artist: 'Joe Perry', years: '1959', guitar: '1959 Standard', notes: 'Aerosmith' },
        { artist: 'Billy Gibbons', years: '1959', guitar: '"Pearly Gates" 1959 Standard', notes: 'ZZ Top - × ×§× ×ª×” ×‘-$250' },
        { artist: 'Randy Rhoads', years: '1974', guitar: '1974 Custom (cream)', notes: 'Ozzy era' },
        { artist: 'Zakk Wylde', years: '1981', guitar: '"The Grail" 1981 Custom Bullseye', notes: '×”×’×™×˜×¨×” ×”××™×™×§×•× ×™×ª' },
        { artist: 'Les Paul', years: '1952', guitar: '1952 Goldtop (×”×“×’× ×”×¨××©×•×Ÿ)', notes: '×”×™×•×¦×¨ ×‘×¢×¦××•' }
      ],
      'Gibson SG': [
        { artist: 'Angus Young', years: '1968', guitar: '1968 SG Standard', notes: 'AC/DC - ×”×’×™×˜×¨×” ×”××“×•××” ×”××™×™×§×•× ×™×ª' },
        { artist: 'Tony Iommi', years: '1965', guitar: '1965 SG Special', notes: 'Black Sabbath - cross inlays ××•×ª×××•×ª' },
        { artist: 'Derek Trucks', years: '1963', guitar: '1963 SG', notes: 'Slide guitar master' },
        { artist: 'Frank Zappa', years: '1962', guitar: '"Baby Snakes" 1962 SG', notes: '×©×¨×•×£ - × ×©×¨×£ ×‘×”×•×¤×¢×”' },
        { artist: 'Robby Krieger', years: '1967', guitar: '1967 SG', notes: 'The Doors' }
      ],
      'Gibson ES-335': [
        { artist: 'B.B. King', years: '1958-1959', guitar: '"Lucille" (××¡×¤×¨ ES-355)', notes: '×œ××¢×©×” ES-355 ×‘×”×ª×××” ××™×©×™×ª' },
        { artist: 'Chuck Berry', years: '1958', guitar: '1958 ES-350T / ES-355', notes: 'Rock n Roll pioneer' },
        { artist: 'Eric Clapton', years: '1964', guitar: '"The Fool" 1964 ES-335', notes: 'Cream era - ×¢× ×¦×™×•×¨×™ ×¤×¡×™×›×“×œ×™×”' },
        { artist: 'Larry Carlton', years: '1968', guitar: '"Mr. 335" 1968', notes: '×”×›×™× ×•×™ ×©×œ×• - ×‘×’×œ×œ ×”×’×™×˜×¨×”' },
        { artist: 'Alvin Lee', years: '1959', guitar: '"Big Red" 1959 ES-335', notes: 'Ten Years After' }
      ],
      'Gibson Flying V': [
        { artist: 'Jimi Hendrix', years: '1967', guitar: '1967 Flying V', notes: '×©×—×•×¨, ×¤×—×•×ª ××•×›×¨ ××”Strat' },
        { artist: 'Albert King', years: '1958', guitar: '"Lucy" 1958 Flying V', notes: 'Blues legend - ×™×× ×™ ×©× ×™×’×Ÿ ×›×©×××œ×™' },
        { artist: 'Michael Schenker', years: '1975', guitar: 'Black/White 1975', notes: 'UFO / Scorpions' },
        { artist: 'Kirk Hammett', years: '1979', guitar: '1979 Flying V', notes: 'Metallica early days' }
      ],
      'PRS Custom 24': [
        { artist: 'Carlos Santana', years: '1980s+', guitar: 'Signature models', notes: '×©×™×ª×•×£ ×¤×¢×•×œ×” ××¨×•×š ×¢× PRS' },
        { artist: 'Mark Tremonti', years: '1990s+', guitar: 'Signature SE & USA', notes: 'Creed / Alter Bridge' },
        { artist: 'Al Di Meola', years: '1990s+', guitar: 'PRS Custom', notes: 'Jazz fusion' }
      ],
      'PRS Silver Sky': [
        { artist: 'John Mayer', years: '2018+', guitar: 'Signature model', notes: '×¢×™×¦×‘ ××ª ×”×“×’× ×¢× Paul Reed Smith' }
      ],
      'Ibanez RG': [
        { artist: 'Steve Vai', years: '1987+', guitar: 'JEM/RG series', notes: '×¢×™×¦×‘ ××ª ×”-JEM ×©×”×¤×š ×œ-RG' },
        { artist: 'Joe Satriani', years: '1988+', guitar: 'JS series (based on RG)', notes: 'Surfing with the Alien' },
        { artist: 'Paul Gilbert', years: '1990s+', guitar: 'PGM series', notes: 'Mr. Big / Racer X' },
        { artist: 'Herman Li', years: '2000s+', guitar: 'EGEN series', notes: 'DragonForce' }
      ],
      'Martin D-28': [
        { artist: 'Hank Williams', years: '1944', guitar: '1944 D-28', notes: 'Country music legend' },
        { artist: 'Neil Young', years: '1968', guitar: '1968 D-45', notes: 'Harvest - ×œ××¢×©×” D-45' },
        { artist: 'Bob Dylan', years: '1963', guitar: 'D-28', notes: 'Folk era' },
        { artist: 'Johnny Cash', years: '1950s', guitar: '××¡×¤×¨ D-28/D-35', notes: 'Man in Black' }
      ]
    };

    // Simple list for backward compatibility
    const FAMOUS_ARTISTS = {};
    Object.keys(FAMOUS_ARTISTS_DETAILED).forEach(key => {
      FAMOUS_ARTISTS[key] = FAMOUS_ARTISTS_DETAILED[key].map(a => a.artist);
    });

    // ===== FAMOUS SONGS DATABASE =====
    const FAMOUS_SONGS = {
      'Fender Stratocaster': [
        { song: 'Purple Haze', artist: 'Jimi Hendrix' },
        { song: 'Sultans of Swing', artist: 'Dire Straits' },
        { song: 'Comfortably Numb', artist: 'Pink Floyd' },
        { song: 'Texas Flood', artist: 'Stevie Ray Vaughan' },
        { song: 'Gravity', artist: 'John Mayer' },
        { song: 'Under the Bridge', artist: 'Red Hot Chili Peppers' },
        { song: 'Layla', artist: 'Derek and the Dominos' }
      ],
      'Fender Telecaster': [
        { song: 'Honky Tonk Women', artist: 'Rolling Stones' },
        { song: 'Born to Run', artist: 'Bruce Springsteen' },
        { song: 'Stairway to Heaven (solo)', artist: 'Led Zeppelin' },
        { song: 'Purple Rain', artist: 'Prince' },
        { song: 'Message in a Bottle', artist: 'The Police' }
      ],
      'Fender Jazzmaster': [
        { song: 'Only Shallow', artist: 'My Bloody Valentine' },
        { song: 'Feel the Pain', artist: 'Dinosaur Jr.' },
        { song: 'Impossible Germany', artist: 'Wilco' }
      ],
      'Fender Jaguar': [
        { song: 'Smells Like Teen Spirit', artist: 'Nirvana' },
        { song: 'This Charming Man', artist: 'The Smiths' },
        { song: 'Marquee Moon', artist: 'Television' }
      ],
      'Gibson Les Paul': [
        { song: 'Whole Lotta Love', artist: 'Led Zeppelin' },
        { song: 'Sweet Child O\' Mine', artist: 'Guns N\' Roses' },
        { song: 'Still Got the Blues', artist: 'Gary Moore' },
        { song: 'Black Magic Woman', artist: 'Fleetwood Mac/Santana' },
        { song: 'Walk This Way', artist: 'Aerosmith' },
        { song: 'Crazy Train', artist: 'Ozzy Osbourne' }
      ],
      'Gibson SG': [
        { song: 'Back in Black', artist: 'AC/DC' },
        { song: 'Highway to Hell', artist: 'AC/DC' },
        { song: 'Iron Man', artist: 'Black Sabbath' },
        { song: 'Paranoid', artist: 'Black Sabbath' }
      ],
      'Gibson ES-335': [
        { song: 'The Thrill Is Gone', artist: 'B.B. King' },
        { song: 'Johnny B. Goode', artist: 'Chuck Berry' },
        { song: 'Room Full of Mirrors', artist: 'Cream' },
        { song: 'Revolution', artist: 'The Beatles' }
      ],
      'PRS Custom 24': [
        { song: 'Smooth', artist: 'Santana ft. Rob Thomas' },
        { song: 'Black Magic Woman', artist: 'Santana' },
        { song: 'Waiting on the World to Change', artist: 'John Mayer' }
      ],
      'Ibanez RG': [
        { song: 'For the Love of God', artist: 'Steve Vai' },
        { song: 'Surfing with the Alien', artist: 'Joe Satriani' },
        { song: 'Technical Difficulties', artist: 'Racer X' }
      ]
    };

    // ===== MAIN FUNCTIONS =====

    function analyzePost() {
      const text = document.getElementById('postText').value;
      const url = document.getElementById('postUrl').value;
      const username = document.getElementById('username').value;

      if (!text) {
        showStatus('×”×–×Ÿ ×˜×§×¡×˜ ×œ× ×™×ª×•×—', 'error');
        return;
      }

      // Detect brand
      let detectedBrand = '';
      for (const brand of BRANDS) {
        if (text.toLowerCase().includes(brand.toLowerCase())) {
          detectedBrand = brand;
          break;
        }
      }
      document.getElementById('brand').value = detectedBrand;

      // Detect model
      let detectedModel = '';
      if (detectedBrand && MODELS[detectedBrand]) {
        for (const model of MODELS[detectedBrand]) {
          if (text.toLowerCase().includes(model.toLowerCase())) {
            detectedModel = model;
            break;
          }
        }
      }
      // Also check common model names
      const allModels = ['Stratocaster', 'Strat', 'Telecaster', 'Tele', 'Les Paul', 'SG', 'ES-335', 'Jazzmaster', 'Jaguar', 'Flying V', 'Explorer', 'Custom 24', 'RG', 'JEM'];
      if (!detectedModel) {
        for (const model of allModels) {
          if (text.toLowerCase().includes(model.toLowerCase())) {
            detectedModel = model;
            // Normalize short forms
            if (detectedModel === 'Strat') detectedModel = 'Stratocaster';
            if (detectedModel === 'Tele') detectedModel = 'Telecaster';
            break;
          }
        }
      }
      document.getElementById('model').value = detectedModel;

      // Detect year (4-digit number between 1950-2026)
      const yearMatch = text.match(/\b(19[5-9]\d|20[0-2]\d)\b/);
      if (yearMatch) {
        document.getElementById('year').value = yearMatch[1];
      }

      // Detect color
      let detectedColor = '';
      for (const color of COLORS) {
        if (text.toLowerCase().includes(color.toLowerCase())) {
          detectedColor = color;
          break;
        }
      }
      document.getElementById('color').value = detectedColor;

      // Detect serial number (common patterns)
      const serialMatch = text.match(/\b([A-Z]?\d{5,10})\b/) || text.match(/serial[:\s#]*([A-Z0-9]+)/i);
      if (serialMatch) {
        document.getElementById('serial').value = serialMatch[1];
      }

      // Create story summary
      const story = createStorySummary(text, username);
      document.getElementById('story').value = story;

      // Enrich with specs, artists, songs
      enrichData();

      showStatus('âœ… ×”××™×“×¢ ×—×•×œ×¥ ×•×”×•×¢×©×¨ ×‘×”×¦×œ×—×”!', 'success');
      generateOutreach();
      updateJSON();
    }

    function createStorySummary(text, username) {
      let story = text.trim();
      story = story.replace(/#\w+/g, '').trim();
      if (story.length > 500) {
        story = story.substring(0, 500) + '...';
      }
      return story;
    }

    function enrichData() {
      const brand = document.getElementById('brand').value;
      const model = document.getElementById('model').value;

      const key = `${brand} ${model}`;

      // Specs
      const specsSection = document.getElementById('specsSection');
      const specsGrid = document.getElementById('specsGrid');

      if (GUITAR_SPECS[key]) {
        const specs = GUITAR_SPECS[key];
        specsGrid.innerHTML = Object.entries(specs).map(([label, value]) => `
          <div class="spec-item">
            <div class="label">${label}</div>
            <div class="value">${value}</div>
          </div>
        `).join('');
        specsSection.style.display = 'block';
      } else {
        specsSection.style.display = 'none';
      }

      // Artists (detailed)
      const artistsSection = document.getElementById('artistsSection');
      const artistsList = document.getElementById('artistsList');
      const year = document.getElementById('year').value;

      if (FAMOUS_ARTISTS_DETAILED[key]) {
        // Filter by year if available, or show all
        let relevantArtists = FAMOUS_ARTISTS_DETAILED[key];

        // If user specified a year, prioritize artists from that era
        if (year) {
          const userYear = parseInt(year);
          relevantArtists = [...FAMOUS_ARTISTS_DETAILED[key]].sort((a, b) => {
            const aYear = parseInt(a.years);
            const bYear = parseInt(b.years);
            const aDiff = Math.abs(aYear - userYear);
            const bDiff = Math.abs(bYear - userYear);
            return aDiff - bDiff;
          });
        }

        artistsList.innerHTML = relevantArtists.slice(0, 5).map(a => `
          <div class="artist-card">
            <div class="artist-name">${a.artist}</div>
            <div class="artist-guitar">${a.guitar}</div>
            <div class="artist-notes">${a.notes}</div>
          </div>
        `).join('');
        artistsSection.style.display = 'block';
      } else {
        artistsSection.style.display = 'none';
      }

      // Songs
      const songsSection = document.getElementById('songsSection');
      const songsList = document.getElementById('songsList');

      if (FAMOUS_SONGS[key]) {
        songsList.innerHTML = FAMOUS_SONGS[key].slice(0, 5).map(item => `
          <div class="song-item">
            <span class="title">${item.song}</span>
            <span class="artist">${item.artist}</span>
          </div>
        `).join('');
        songsSection.style.display = 'block';
      } else {
        songsSection.style.display = 'none';
      }

      updateJSON();
    }

    function updateJSON() {
      const brand = document.getElementById('brand').value;
      const model = document.getElementById('model').value;
      const key = `${brand} ${model}`;

      const data = {
        source: 'instagram',
        post_url: document.getElementById('postUrl').value,
        author: {
          username: document.getElementById('username').value,
          profile_url: `https://instagram.com/${document.getElementById('username').value.replace('@', '')}`
        },
        guitar: {
          brand: brand,
          model: model,
          year: document.getElementById('year').value,
          color: document.getElementById('color').value,
          serial: document.getElementById('serial').value,
          condition: document.getElementById('condition').value
        },
        story: document.getElementById('story').value,
        images: document.getElementById('imageUrls').value.split('\n').filter(u => u.trim()),
        // Enriched data
        suggested_specs: GUITAR_SPECS[key] || null,
        famous_artists: FAMOUS_ARTISTS_DETAILED[key] || [],
        famous_songs: FAMOUS_SONGS[key] || [],
        // Metadata
        extracted_at: new Date().toISOString().split('T')[0],
        status: 'unclaimed'
      };

      document.getElementById('jsonOutput').textContent = JSON.stringify(data, null, 2);
    }

    // Outreach messages
    const outreachTemplates = {
      en: `Hey {username}! ğŸ‘‹

I came across your post about your {brand} {model} and absolutely loved the story behind it.

I'm building TWNG (twng.com) - a platform where guitarists can document and preserve their guitars' stories. Think of it as a digital home for every guitar's journey.

I'd love to feature your {brand} on TWNG. I've already started creating a profile for it based on your post - you can claim it, add more details, and share it with the community.

Would you be interested? I can send you a direct link to claim your guitar's profile.

ğŸ¸ Every guitar has a story. Let's make sure yours is preserved.`,

      he: `×”×™×™ {username}! ğŸ‘‹

× ×ª×§×œ×ª×™ ×‘×¤×•×¡×˜ ×©×œ×š ×¢×œ ×”-{brand} {model} ×•×¤×©×•×˜ ××”×‘×ª×™ ××ª ×”×¡×™×¤×•×¨ ×××—×•×¨×™ ×”×’×™×˜×¨×”.

×× ×™ ×‘×•× ×” ××ª TWNG (twng.com) - ×¤×œ×˜×¤×•×¨××” ×©×‘×” ×’×™×˜×¨×™×¡×˜×™× ×™×›×•×œ×™× ×œ×ª×¢×“ ×•×œ×©××¨ ××ª ×”×¡×™×¤×•×¨×™× ×©×œ ×”×’×™×˜×¨×•×ª ×©×œ×”×. ×ª×—×©×•×‘ ×¢×œ ×–×” ×›××• ×‘×™×ª ×“×™×’×™×˜×œ×™ ×œ××¡×¢ ×©×œ ×›×œ ×’×™×˜×¨×”.

××©××— ×œ××¨×— ××ª ×”-{brand} ×©×œ×š ×‘-TWNG. ×›×‘×¨ ×”×ª×—×œ×ª×™ ×œ×™×¦×•×¨ ×¤×¨×•×¤×™×œ ×‘×”×ª×‘×¡×¡ ×¢×œ ×”×¤×•×¡×˜ ×©×œ×š - ×ª×•×›×œ ×œ×ª×‘×•×¢ ××•×ª×•, ×œ×”×•×¡×™×£ ×¤×¨×˜×™× × ×•×¡×¤×™×, ×•×œ×©×ª×£ ×¢× ×”×§×”×™×œ×”.

××¢× ×™×™×Ÿ ××•×ª×š? ×× ×™ ×™×›×•×œ ×œ×©×œ×•×— ×œ×š ×œ×™× ×§ ×™×©×™×¨ ×œ×ª×‘×•×¢ ××ª ×”×¤×¨×•×¤×™×œ ×©×œ ×”×’×™×˜×¨×” ×©×œ×š.

ğŸ¸ ×œ×›×œ ×’×™×˜×¨×” ×™×© ×¡×™×¤×•×¨. ×‘×•× × ×•×•×“× ×©×”×¡×™×¤×•×¨ ×©×œ×š × ×©××¨.`
    };

    let currentLang = 'en';

    function switchLang(lang) {
      currentLang = lang;
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.querySelector(`.tab[onclick="switchLang('${lang}')"]`).classList.add('active');
      generateOutreach();
    }

    function generateOutreach() {
      const username = document.getElementById('username').value || 'there';
      const brand = document.getElementById('brand').value || 'guitar';
      const model = document.getElementById('model').value || '';

      let message = outreachTemplates[currentLang]
        .replace(/{username}/g, username.replace('@', ''))
        .replace(/{brand}/g, brand)
        .replace(/{model}/g, model);

      document.getElementById('outreachMessage').value = message;
    }

    function copyOutreach() {
      const message = document.getElementById('outreachMessage').value;
      navigator.clipboard.writeText(message);
      showStatus('âœ… ×”×”×•×“×¢×” ×”×•×¢×ª×§×”!', 'success');
    }

    function copyGuitarJSON() {
      const json = document.getElementById('jsonOutput').textContent;
      navigator.clipboard.writeText(json);
      showStatus('âœ… JSON ×”×•×¢×ª×§!', 'success');
    }

    function openInstagramDM() {
      const username = document.getElementById('username').value.replace('@', '');
      if (username) {
        window.open(`https://instagram.com/direct/t/${username}`, '_blank');
      } else {
        showStatus('×”×–×Ÿ ×©× ××©×ª××©', 'error');
      }
    }

    function showStatus(message, type) {
      const statusEl = document.getElementById('statusMessage');
      statusEl.innerHTML = `<div class="status ${type}">${message}</div>`;
      setTimeout(() => statusEl.innerHTML = '', 3000);
    }

    // Initialize
    generateOutreach();
  </script>
</body>
</html>
